<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Grocery List</title>
    <meta charset="UTF-8" />
    <link rel="stylesheet" type="text/css" th:href="@{/css/styles.css}" />
</head>
<body>

<h1>Grocery List</h1>

<form th:action="@{/grocerylist}" method="get" style="margin-bottom:20px;">
    <label for="mealPlanSelect">Select Meal Plan:</label>
    <select id="mealPlanSelect" name="mealPlanId" onchange="this.form.submit()" required>
        <option value="" disabled th:if="${selectedMealPlanId == null}" selected>Select Meal Plan</option>
        <option th:each="plan : ${mealPlans}"
                th:value="${plan.id}"
                th:text="${plan.name}"
                th:selected="${plan.id == selectedMealPlanId}">
        </option>
    </select>
</form>

<form th:if="${groceryList != null and !#lists.isEmpty(groceryList)}" th:action="@{/grocerylist}" method="post">
    <input type="hidden" th:name="mealPlanId" th:value="${selectedMealPlanId}" />
    <table class="styled-table" style="width:70%; margin:auto;">
        <thead>
        <tr>
            <th>Ingredient</th>
            <th>Unit</th>
            <th>Quantity</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="entry, iterStat : ${groceryList}">
            <td th:text="${entry.ingredientName}">Ingredient Name</td>
            <td th:text="${entry.unit}">Unit</td>
            <td>
                <input type="hidden" name="ingredientIds" th:value="${entry.ingredientId}" />
                <input type="number" step="0.01" min="0" name="quantities" th:value="${entry.quantity}" required />
            </td>
        </tr>
        </tbody>
    </table>
    <div style="text-align: center; margin-top: 20px;">
        <button type="submit" class="button">Save Grocery List</button>
    </div>
</form>

<div th:if="${selectedMealPlanId == null}">
    <p style="text-align:center; margin-top:30px;">Select a Meal Plan to generate its grocery list.</p>
</div>

<a href="/" class="button secondary" style="display:block; width: 100px; margin: 40px auto;">Back to Home</a>

<script src="/js/scripts.js"></script>
</body>
</html>
